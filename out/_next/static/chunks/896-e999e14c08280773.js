"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[896],{9674:function(e,t,a){a.d(t,{Z:function(){return k}});var l=a(7437),r=a(2265),c=a(947),o=a(3661),s=a(1418),n=a(3572),d=a(1951),i=a(626),b=e=>{let{type:t,index:a,id:c,moveBlock:o,setBlocks:s}=e,n=(0,r.useRef)(null),b="red",u=!1,x="";switch(t.toLowerCase()){case"wait":b="#00a4e6",x="1s";break;case"forward":b="#deca23",x="&uarr;";break;case"reverse":b="#deca23",x="&darr;";break;case"left":b="#deca23",x="&larr;";break;case"right":b="#deca23",x="&rarr;";break;case"for":case"end for":b="#efaac4",u=!0;break;default:console.log("Invalid type")}let h=(e,t)=>{s(a=>a.map((a,l)=>l===e?{...a,loop_details:{...a.loop_details,num_loops:parseInt(t,10)}}:a))},[{isDragging:f},m]=(0,d.c)({type:"BLOCK",item:{index:a,id:c},collect:e=>({isDragging:e.isDragging()})}),[,w]=(0,i.L)({accept:"BLOCK",hover:(e,t)=>{e.index!==a&&(o(e.index,a),e.index=a)}});return(m(n),w(n),u)?(0,l.jsx)("div",{ref:n,className:"w-full",children:(0,l.jsxs)("div",{className:"flex cursor-grab active:cursor-grabbing relative w-48 h-9 rounded-md border-2 border-black",style:{backgroundColor:b},children:[(0,l.jsx)("h1",{className:"text-lg font-bold z-10 absolute top-0.5 left-3 text-black",children:t}),"For"===t?(0,l.jsx)("input",{className:"bg-[#d182a0] rounded-md flex text-lg w-8 pl-2 text-black font-bold z-10 absolute top-0.5 right-4 text-black",type:"number",id:"quantity",name:"quantity",min:"1",max:"99",step:"1",placeholder:"1",onChange:e=>h(a,e.target.value)}):(0,l.jsx)(l.Fragment,{})]})}):(0,l.jsx)("div",{ref:n,className:"w-full",children:(0,l.jsxs)("div",{className:"flex cursor-grab active:cursor-grabbing relative w-40 h-9 rounded-md border-2 border-black",style:{backgroundColor:b},children:[(0,l.jsx)("h1",{className:"text-lg font-bold z-10 absolute top-0.5 left-3 text-black",children:t}),(0,l.jsx)("h1",{className:"text-lg font-bold z-10 ml-2 absolute top-0.5 right-2 text-black",dangerouslySetInnerHTML:{__html:x}})]})})},u=a(9172);let x=e=>{let{onDropTrashCan:t,handleDelete:a}=e,[c,o]=(0,r.useState)(!1),[,s]=(0,i.L)({accept:"BLOCK",drop:e=>{o(!1),t(e)},collect:e=>({isOver:e.isOver()})});return(0,l.jsx)("div",{ref:s,className:"trashcan z-10 sticky absolute right-0 bottom-0 flex flex-row-reverse ".concat(c?"drag-over":""),children:(0,l.jsx)("div",{className:"cursor-pointer",onClick:a,onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:(0,l.jsx)(u.Xm5,{size:50})})})};var h=e=>{let{blocks:t,setBlocks:a}=e,r=(e,l)=>{let r=[...t],[c]=r.splice(e,1);r.splice(l,0,c),a(r)},c=e=>{a(t=>t.filter(t=>t.id!==e.id))};return(0,l.jsxs)("div",{className:"relative flex flex-col h-[400px] md:h-[600px] w-full justify-between",children:[(0,l.jsx)("div",{children:t.map((e,t)=>(0,l.jsx)(b,{type:e.type,index:t,id:e.id,moveBlock:r,loop_details:e.loop_details,setBlocks:a},t))}),(0,l.jsx)(x,{handleDelete:()=>{0!=t.length&&window.confirm("Are you sure you want to clear your program?")&&a([])},onDropTrashCan:e=>c(e)})]})};let f=e=>{let t=[],a=0,l=0,r=0,c=0,o=1;for(let n=0;n<e.length;n++){let d=e[n];if("For"===d.type){if(0==a){var s;r=n,o=(null===(s=d.loop_details)||void 0===s?void 0:s.num_loops)||1}a++}else if("End for"===d.type){if(a===++l){c=n,a=0,l=0;let s=e.slice(r+1,c);t.push(...f(m(s,o)))}}else 0==a&&t.push(d.type)}return t},m=(e,t)=>Array.from({length:t},()=>[...e]).flat(),w=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l="",r="",c="",o="";if(a)switch(e){case"Forward":l="1".concat(t),r="1".concat(t),c="0".concat(t),o="0".concat(t);break;case"Reverse":l="0".concat(t),r="0".concat(t),c="1".concat(t),o="1".concat(t);break;case"Left":l="1".concat(t),r="0".concat(t),c="1".concat(t),o="0".concat(t);break;case"Right":l="0".concat(t),r="1".concat(t),c="0".concat(t),o="1".concat(t);break;default:l="0000",r="0000",c="0000",o="0000"}else switch(e){case"Forward":l="1".concat(t),r="1".concat(t),c="1".concat(t),o="1".concat(t);break;case"Reverse":l="0".concat(t),r="0".concat(t),c="0".concat(t),o="0".concat(t);break;case"Left":l="1".concat(t),r="1".concat(t),c="0".concat(t),o="0".concat(t);break;case"Right":l="0".concat(t),r="0".concat(t),c="1".concat(t),o="1".concat(t);break;default:l="0000",r="0000",c="0000",o="0000"}return"M".concat(l).concat(r).concat(c).concat(o,"\n")};var k=e=>{let{isDemoBot:t,websocket_address:a,motor_speed:d,operation_duration_milliseconds:i}=e;t=t||!1;let[b,u]=(0,r.useState)([]),[x,m]=(0,r.useState)(!1),k=(0,r.useCallback)(async e=>{let l;new Promise((e,t)=>{try{let l=new WebSocket(a);l.onopen=()=>{e(l)},l.onerror=e=>{t(e)}}catch(e){t(e)}}).then(e=>{l=e},e=>{console.error(e),m(!1)});for(let a=0;a<e.length;a++){if(await new Promise(e=>setTimeout(e,2e3)),(null==l?void 0:l.readyState)!=1){console.log(l),m(!1);return}let r=w(e[a],d,t);l.send(r),await new Promise(e=>setTimeout(e,i)),l.send("M0000000000000000\n")}m(!1),null==l||l.close()},[t,a,d,i]),g=e=>{let t=b.length+1;if("For"===e){let a={id:t,type:e,loop_details:{num_loops:1}},l={id:t+1,type:"End for"};u(e=>[...e,a,l])}else{let a={id:t,type:e};u(e=>[...e,a])}};return(0,l.jsx)(c.W,{backend:"ontouchstart"in window?s.zr:o.PD,children:(0,l.jsxs)("div",{className:"w-full flex flex-col items-center",children:[(0,l.jsx)("div",{className:"overflow-scroll relative w-11/12 max-w-[1000px] h-1/2 mt-10 p-3 border-4 border-ukblue rounded-xl bg-white shadow-lg",children:(0,l.jsx)(h,{blocks:b,setBlocks:u})}),(0,l.jsxs)("div",{className:"btn-menu w-11/12 max-w-[1000px] mt-8 mb-4 border-2 border-white flex flex-col p-2",children:[(0,l.jsxs)("div",{className:"btn-row flex flex-row justify-between items-center",children:[(0,l.jsx)(n.Z,{style:{backgroundColor:"#efaac4"},className:"border-2 border-black text-black w-24 m-0",onClick:()=>g("For"),children:"For Loop"}),(0,l.jsx)(n.Z,{style:{backgroundColor:"#deca23"},className:"border-2 border-black text-black w-24",onClick:()=>g("Forward"),children:"Forward"}),(0,l.jsx)("div",{className:"w-24"})]}),(0,l.jsxs)("div",{className:"btn-row flex flex-row justify-between items-center mt-4",children:[(0,l.jsx)(n.Z,{style:{backgroundColor:"#deca23"},className:"border-2 border-black text-black w-24",onClick:()=>g("Left"),children:"Left"}),(0,l.jsx)(n.Z,{style:{backgroundColor:"#00a4e6"},className:"border-2 border-black text-black w-24",onClick:()=>g("Wait"),children:"Wait"}),(0,l.jsx)(n.Z,{style:{backgroundColor:"#deca23"},className:"border-2 border-black text-black w-24",onClick:()=>g("Right"),children:"Right"})]}),(0,l.jsxs)("div",{className:"btn-row flex flex-row-reverse justify-between items-center mt-4",children:[(0,l.jsx)(n.Z,{className:"border-2 border-black text-black w-24 shadow-lg shadow-green ".concat(x?"connected":"disconnected"),onClick:x?()=>{}:()=>{b.length>0&&(m(!0),k(f(b)))},children:x?"STOP":"Run"}),(0,l.jsx)(n.Z,{style:{backgroundColor:"#deca23"},className:"border-2 border-black text-black w-24",onClick:()=>g("Reverse"),children:"Reverse"}),(0,l.jsx)("div",{className:"w-24"})]})]})]})})}},7775:function(e,t,a){var l=a(7437);a(2265);var r=a(6691),c=a.n(r);t.Z=e=>{let{title:t}=e;return(0,l.jsx)("div",{className:"top-bar container-center bg-midnight shadow-lg text-white p-4 w-full h-[10%]",children:(0,l.jsxs)("div",{className:"flex flex-row",children:[(0,l.jsx)(c(),{className:"w-auto h-auto",src:"/kora-logo.png",alt:"KORA Logo",width:100,height:50}),(0,l.jsxs)("h1",{className:"text-4xl italic font-bold ml-3",children:[" ",t," "]})]})})}}}]);